<!doctype html><html lang=en itemscope itemtype=http://schema.org/WebPage><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><title>Hybrid Application Using QML and Qt C++ - xizzhu</title><meta name=description content="Though QML provides a nice way to design user interfaces, and JavaScript is employed there to implement the application logic and works pretty nice in many cases, we might still need Qt C++ in some situations (well, at least JavaScript has limited access outside its sandbox)."><meta name=author content="Xizhi Zhu"><script type=application/ld+json>{"@context":"http://schema.org","@type":"WebSite","name":"xizzhu","url":"https:\/\/xizzhu.me\/"}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"Organization","name":"","url":"https:\/\/xizzhu.me\/"}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"https:\/\/xizzhu.me\/","name":"home"}},{"@type":"ListItem","position":3,"item":{"@id":"https:\/\/xizzhu.me\/post\/2010-10-28-hybrid-qml-qt\/","name":"Hybrid application using qml and qt c"}}]}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"Article","author":{"name":"Xizhi Zhu"},"headline":"Hybrid Application Using QML and Qt C\u002b\u002b","description":"Though QML provides a nice way to design user interfaces, and JavaScript is employed there to implement the application logic and works pretty nice in many cases, we might still need Qt C\u002b\u002b in some situations (well, at least JavaScript has limited access outside its sandbox).\n","inLanguage":"en","wordCount":756,"datePublished":"2010-10-28T00:00:00","dateModified":"2010-10-28T00:00:00","image":"https:\/\/xizzhu.me\/images\/logo.png","keywords":["qt"],"mainEntityOfPage":"https:\/\/xizzhu.me\/post\/2010-10-28-hybrid-qml-qt\/","publisher":{"@type":"Organization","name":"https:\/\/xizzhu.me\/","logo":{"@type":"ImageObject","url":"https:\/\/xizzhu.me\/images\/logo.png","height":60,"width":60}}}</script><meta property="og:title" content="Hybrid Application Using QML and Qt C++"><meta property="og:description" content="Though QML provides a nice way to design user interfaces, and JavaScript is employed there to implement the application logic and works pretty nice in many cases, we might still need Qt C++ in some situations (well, at least JavaScript has limited access outside its sandbox)."><meta property="og:image" content="https://xizzhu.me/images/logo.png"><meta property="og:url" content="https://xizzhu.me/post/2010-10-28-hybrid-qml-qt/"><meta property="og:type" content="website"><meta property="og:site_name" content="xizzhu"><meta name=twitter:title content="Hybrid Application Using QML and Qt C++"><meta name=twitter:description content="Though QML provides a nice way to design user interfaces, and JavaScript is employed there to implement the application logic and works pretty nice in many cases, we might still need Qt C++ in some …"><meta name=twitter:image content="https://xizzhu.me/images/logo.png"><meta name=twitter:card content="summary"><link href=https://xizzhu.me/images/logo.png rel=icon type=image/x-icon><meta name=generator content="Hugo 0.111.3"><link rel=alternate href=https://xizzhu.me/index.xml type=application/rss+xml title=xizzhu><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css integrity=sha384-9eLZqc9ds8eNjO3TmqPeYcDj8n+Qfa4nuSiGYa6DjLNcv9BtN69ZIulL9+8CqC9Y crossorigin=anonymous><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.5.0/css/all.css integrity=sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU crossorigin=anonymous><link rel=stylesheet href=https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css integrity=sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u crossorigin=anonymous><link rel=stylesheet href=https://xizzhu.me/css/main.css><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic"><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800"><link rel=stylesheet href=https://xizzhu.me/css/syntax.css><link rel=stylesheet href=https://xizzhu.me/css/codeblock.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.css integrity=sha384-h/L2W9KefUClHWaty3SLE5F/qvc4djlyR4qY3NUV5HGQBBW7stbcfff1+I/vmsHh crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/default-skin/default-skin.min.css integrity=sha384-iD0dNku6PYSIQLyfTOpB06F2KCZJAKLOThS5HRe8b3ibhdEQ6eKsFf/EeFxdOt5R crossorigin=anonymous><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-128400000-1","auto"),ga("send","pageview"))</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body><nav class="navbar navbar-default navbar-fixed-top navbar-custom"><div class=container-fluid><div class=navbar-header><button type=button class=navbar-toggle data-toggle=collapse data-target=#main-navbar>
<span class=sr-only>Toggle navigation</span>
<span class=icon-bar></span>
<span class=icon-bar></span>
<span class=icon-bar></span></button>
<a class=navbar-brand href=https://xizzhu.me/>xizzhu</a></div><div class="collapse navbar-collapse" id=main-navbar><ul class="nav navbar-nav navbar-right"><li><a title=About href=/pages/about/>About</a></li><li><a title=Posts href=/post>Posts</a></li><li><a title=Bible href=/bible>Bible</a></li><li><a title=随笔 href=/%e9%9a%8f%e7%ac%94>随笔</a></li></ul></div><div class=avatar-container><div class=avatar-img-border><a title=xizzhu href=https://xizzhu.me/><img class=avatar-img src=https://xizzhu.me/images/logo.png alt=xizzhu></a></div></div></div></nav><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><header class=header-section><div class="intro-header no-img"><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class=post-heading><h1>Hybrid Application Using QML and Qt C++</h1><span class=post-meta><i class="fas fa-calendar"></i>&nbsp;Posted on October 28, 2010
&nbsp;|&nbsp;<i class="fas fa-user"></i>&nbsp;Xizhi Zhu</span></div></div></div></div></div></header><div class=container role=main><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><article role=main class=blog-post><p>Though QML provides a nice way to design user interfaces, and JavaScript is employed there to implement the application logic and works pretty nice in many cases, we might still need Qt C++ in some situations (well, at least JavaScript has limited access outside its sandbox).</p><h2 id=integrate-qml-into-qt-c>Integrate QML into Qt C++</h2><p>Suppose we have a QML file, named <em>myqml.qml</em>, like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-qml data-lang=qml><span style=display:flex><span><span style=color:#75715e>// this line should be &#34;import QtQuick 1.0&#34; since Qt 4.7.1
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>Qt</span> <span style=color:#ae81ff>4.7</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#a6e22e>Rectangle</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>id: myRectangle</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>width:</span> <span style=color:#ae81ff>800</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>height:</span> <span style=color:#ae81ff>480</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>color:</span> <span style=color:#e6db74>&#34;lightgray&#34;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>Text</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>id: myText</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>text:</span> <span style=color:#e6db74>&#34;I love hybrid application!&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>anchors.centerIn:</span> <span style=color:#a6e22e>parent</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>font.pointSize:</span> <span style=color:#ae81ff>28</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>font.bold:</span> <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}</span></span></code></pre></div><p>One easy way to integrate is to use the QDeclarativeView class, which provides a widget to display QML files. You just need the following three lines:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span>QDeclarativeView view;
</span></span><span style=display:flex><span>view.setSource(QUrl<span style=color:#f92672>::</span>fromLocalFile(<span style=color:#e6db74>&#34;myqml.qml&#34;</span>));
</span></span><span style=display:flex><span>view.show();</span></span></code></pre></div><p>However, <em>QDeclarativeView</em> consumes more resources than normal widgets. Fortunately, we can <strong>integrate QML into a graphics scene</strong>. The following lines shows the basic usage:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#75715e>// provides an environment for instantiating QML components
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>QDeclarativeEngine engine;
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#75715e>// encapsulates a QML component definition
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>QDeclarativeComponent <span style=color:#a6e22e>component</span>(<span style=color:#f92672>&amp;</span>engine, QUrl<span style=color:#f92672>::</span>fromLocalFile(<span style=color:#e6db74>&#34;myqml.qml&#34;</span>));
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#75715e>// creates the graphics item for QML at the engine&#39;s root context
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>QDeclarativeItem <span style=color:#f92672>*</span>item <span style=color:#f92672>=</span> qobject_cast<span style=color:#f92672>&lt;</span>QDeclarativeItem <span style=color:#f92672>*&gt;</span>(component.create());
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>scene.addItem(item);</span></span></code></pre></div><p>Then with the help of the QDeclarativeItem class, you can easily <strong>access the properties of the QML element</strong>, e.g.:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span>qDebug() <span style=color:#f92672>&lt;&lt;</span> item<span style=color:#f92672>-&gt;</span>property(<span style=color:#e6db74>&#34;color&#34;</span>).typeName();
</span></span><span style=display:flex><span>item<span style=color:#f92672>-&gt;</span>setProperty(<span style=color:#e6db74>&#34;color&#34;</span>, QColor(<span style=color:#ae81ff>255</span>, <span style=color:#ae81ff>255</span>, <span style=color:#ae81ff>255</span>));</span></span></code></pre></div><h2 id=exposing-qt-c-objects-to-qml>Exposing Qt C++ objects to QML</h2><p>You can also expose <strong>native Qt C++ objects to QML</strong> through <em>QDeclarativeContext</em>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span>QDeclarativeContext <span style=color:#f92672>*</span>context <span style=color:#f92672>=</span> engine<span style=color:#f92672>-&gt;</span>rootContext();
</span></span><span style=display:flex><span>context<span style=color:#f92672>-&gt;</span>setContextProperty(<span style=color:#e6db74>&#34;textFromQt&#34;</span>, QString(<span style=color:#e6db74>&#34;I love hybrid application!&#34;</span>));</span></span></code></pre></div><p>Then in QML, you can have e.g. the following line to access them:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-qml data-lang=qml><span style=display:flex><span><span style=color:#66d9ef>text:</span> <span style=color:#a6e22e>textFromQt</span></span></span></code></pre></div><p>You can also use <em>QDeclarativePropertyMap</em> to manage the exposed properties:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span>QDeclarativePropertyMap map;
</span></span><span style=display:flex><span>map.insert(<span style=color:#e6db74>&#34;key1&#34;</span>, <span style=color:#e6db74>&#34;value1&#34;</span>);
</span></span><span style=display:flex><span>map.insert(<span style=color:#e6db74>&#34;key2&#34;</span>, <span style=color:#e6db74>&#34;value2&#34;</span>);
</span></span><span style=display:flex><span>context<span style=color:#f92672>-&gt;</span>setContextProperty(<span style=color:#e6db74>&#34;map&#34;</span>, <span style=color:#f92672>&amp;</span>map);</span></span></code></pre></div><p>In a QML engine, there could be a couple of contexts, forming a tree structure. The child contexts inherit properties in the parent context. By default, there is only one root context, but you can always add more to give finer control of the exposed data, i.e. different QDeclarativeComponent inside the same context have the same exposed data set.</p><p>To <strong>expose a self-defined object</strong>, we can use the following code:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#75715e>// define a class with properties
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>MyObject</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>public</span> QObject
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  Q_OBJECT
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// the NOTIFY signal is needed to inform about changes
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#75715e>// all properties will be exposed to QML
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  Q_PROPERTY(QString text READ text WRITE setText NOTIFY textChanged)
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>  MyObject(QObject <span style=color:#f92672>*</span>parent <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>) <span style=color:#f92672>:</span> QObject(parent), m_text(<span style=color:#e6db74>&#34;I love hybrid application!&#34;</span>) {}
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  QString <span style=color:#a6e22e>text</span>() <span style=color:#66d9ef>const</span> { <span style=color:#66d9ef>return</span> m_text; }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>setText</span>(QString <span style=color:#f92672>&amp;</span>text)
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    m_text <span style=color:#f92672>=</span> text;
</span></span><span style=display:flex><span>    emit textChanged();
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>signals:
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>void</span> textChanged();
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#66d9ef>private</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>  QString m_text;
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#75715e>// then just expose it so QML can access it through name &#34;myObject&#34;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>engine<span style=color:#f92672>-&gt;</span>rootContext()<span style=color:#f92672>-&gt;</span>setContextProperty(<span style=color:#e6db74>&#34;myObject&#34;</span>, <span style=color:#66d9ef>new</span> MyObject());</span></span></code></pre></div><p>Moreover, we can <strong>create new QML types</strong>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#75715e>// define the new type
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>MyType</span> <span style=color:#f92672>:</span> <span style=color:#66d9ef>public</span> QDeclarativeItem
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  Q_OBJECT
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>  MyType(QDeclarativeItem <span style=color:#f92672>*</span>parent <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>) <span style=color:#f92672>:</span> QDeclarativeItem(parent)
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    setFlag(QGraphicsItem<span style=color:#f92672>::</span>ItemHasNoContents, false);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>paint</span>(QPainter <span style=color:#f92672>*</span>painter, <span style=color:#66d9ef>const</span> QStyleOptionGraphicsItem <span style=color:#f92672>*</span>option, QWidget <span style=color:#f92672>*</span>widget <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    QPen pen(QColor(<span style=color:#ae81ff>100</span>, <span style=color:#ae81ff>100</span>, <span style=color:#ae81ff>100</span>), <span style=color:#ae81ff>2</span>);
</span></span><span style=display:flex><span>    painter<span style=color:#f92672>-&gt;</span>setPen(pen);
</span></span><span style=display:flex><span>    painter<span style=color:#f92672>-&gt;</span>drawLine(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>100</span>, <span style=color:#ae81ff>100</span>, <span style=color:#ae81ff>100</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#75715e>// then register to expose it
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>qmlRegisterType<span style=color:#f92672>&lt;</span>mychart<span style=color:#f92672>&gt;</span>(<span style=color:#e6db74>&#34;net.zionsoft.mytype&#34;</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#e6db74>&#34;MyType&#34;</span>);</span></span></code></pre></div><p>In QML, you can use it like this:<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-qml data-lang=qml><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>net</span>.<span style=color:#a6e22e>zionsoft</span>.<span style=color:#a6e22e>mytype</span> <span style=color:#ae81ff>1.0</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#a6e22e>MyChart</span> {
</span></span><span style=display:flex><span> <span style=color:#66d9ef>id: myChart</span>
</span></span><span style=display:flex><span> <span style=color:#66d9ef>width:</span> <span style=color:#ae81ff>100</span>
</span></span><span style=display:flex><span> <span style=color:#66d9ef>height:</span> <span style=color:#ae81ff>200</span>
</span></span><span style=display:flex><span>}</span></span></code></pre></div></p><p>Now let’s jump to <strong>invoke a Qt C++ function from QML</strong>. Basically, QML can invoke slots and functions declared with <em>Q_INVOKABLE</em>. Suppose we have the following function in MyObject:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span>Q_INVOKABLE <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>showMessage</span>()
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  QMessageBox<span style=color:#f92672>::</span>information(NULL, <span style=color:#e6db74>&#34;My Test&#34;</span>, <span style=color:#e6db74>&#34;Invoking a native function ;)&#34;</span>);
</span></span><span style=display:flex><span>}</span></span></code></pre></div><p>Then you can invoke it in QML:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-qml data-lang=qml><span style=display:flex><span><span style=color:#a6e22e>myObject</span>.<span style=color:#a6e22e>showMessage</span>();</span></span></code></pre></div><h2 id=write-plugins-as-qml-extension>Write plugins as QML extension</h2><p>The benefits for using plugins as QML extensions are similar to using shared libraries, and it can be easily achieved with the help of <em>QDeclarativeExtensionPlugin</em>. Let’s reuse the MyType class defined in the previous section.</p><p>First, we need to <strong>create a plugin</strong>:<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>MyPlugin</span> <span style=color:#f92672>:</span> <span style=color:#66d9ef>public</span> QDeclarativeExtensionPlugin
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  Q_OBJECT
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>void</span> registerTypes(<span style=color:#66d9ef>const</span> <span style=color:#66d9ef>char</span> <span style=color:#f92672>*</span>uri)
</span></span><span style=display:flex><span>  {
</span></span><span style=display:flex><span>    qmlRegisterType<span style=color:#f92672>&lt;</span>MyType<span style=color:#f92672>&gt;</span>(uri, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#e6db74>&#34;MyType&#34;</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>Q_EXPORT_PLUGIN2(myPlugin, MyPlugin);</span></span></code></pre></div></p><p>Then create a file named <em>qmldir</em> to define which plugin to load from where (suppose the plugin is called <em>myplugin</em>):</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>plugin myplugin /path/to/plugin</span></span></code></pre></div><p>Now we can use qmlviewer to launch the QML file:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-qml data-lang=qml><span style=display:flex><span><span style=color:#75715e>// no need to import now
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>MyChart</span> {
</span></span><span style=display:flex><span> <span style=color:#66d9ef>id: myChart</span>
</span></span><span style=display:flex><span> <span style=color:#66d9ef>width:</span> <span style=color:#ae81ff>100</span>
</span></span><span style=display:flex><span> <span style=color:#66d9ef>height:</span> <span style=color:#ae81ff>200</span>
</span></span><span style=display:flex><span>}</span></span></code></pre></div><h2 id=summary>summary</h2><ul><li>Use <em>QDeclarativeView</em> or <em>QDeclarativeComponent</em> to integrate a QML file into native Qt C++.</li><li>Qt C++ can access the properties of QML elements through <em>QDeclarativeItem</em>.</li><li>Expose native objects to QML through <em>QDeclarativeContext</em>.</li><li>New QML types can be exported through <em>qmlRegisterType</em>.</li><li>The properties of native objects are exported as properties, and the slots or functions declared with <em>Q_INVOKABLE</em> can be invoked in QML.</li><li>Create plugins for extension using <em>QDeclarativeExtensionPlugin</em>.</li></ul><div class=blog-tags><a href=https://xizzhu.me//tags/qt/>qt</a>&nbsp;</div><hr><section id=social-share><div class="list-inline footer-links"><div class=share-box aria-hidden=true><ul class=share><li><a href="//twitter.com/share?url=https%3a%2f%2fxizzhu.me%2fpost%2f2010-10-28-hybrid-qml-qt%2f&amp;text=Hybrid%20Application%20Using%20QML%20and%20Qt%20C%2b%2b&amp;via=" target=_blank title="Share on Twitter"><i class="fab fa-twitter"></i></a></li><li><a href="//www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fxizzhu.me%2fpost%2f2010-10-28-hybrid-qml-qt%2f" target=_blank title="Share on Facebook"><i class="fab fa-facebook"></i></a></li><li><a href="//reddit.com/submit?url=https%3a%2f%2fxizzhu.me%2fpost%2f2010-10-28-hybrid-qml-qt%2f&amp;title=Hybrid%20Application%20Using%20QML%20and%20Qt%20C%2b%2b" target=_blank title="Share on Reddit"><i class="fab fa-reddit"></i></a></li><li><a href="//www.linkedin.com/shareArticle?url=https%3a%2f%2fxizzhu.me%2fpost%2f2010-10-28-hybrid-qml-qt%2f&amp;title=Hybrid%20Application%20Using%20QML%20and%20Qt%20C%2b%2b" target=_blank title="Share on LinkedIn"><i class="fab fa-linkedin"></i></a></li><li><a href="//www.stumbleupon.com/submit?url=https%3a%2f%2fxizzhu.me%2fpost%2f2010-10-28-hybrid-qml-qt%2f&amp;title=Hybrid%20Application%20Using%20QML%20and%20Qt%20C%2b%2b" target=_blank title="Share on StumbleUpon"><i class="fab fa-stumbleupon"></i></a></li><li><a href="//www.pinterest.com/pin/create/button/?url=https%3a%2f%2fxizzhu.me%2fpost%2f2010-10-28-hybrid-qml-qt%2f&amp;description=Hybrid%20Application%20Using%20QML%20and%20Qt%20C%2b%2b" target=_blank title="Share on Pinterest"><i class="fab fa-pinterest"></i></a></li></ul></div></div></section><h4 class=see-also>See also</h4><ul><li><a href=/post/2010-11-25-qt-private-impl/>D-Pointer / Private Implementation in Qt</a></li></ul></article><ul class="pager blog-pager"><li class=next><a href=https://xizzhu.me/post/2010-11-25-qt-private-impl/ data-toggle=tooltip data-placement=top title="D-Pointer / Private Implementation in Qt">Next Post &rarr;</a></li></ul><div class=disqus-comments><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//xizhi-zhu.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></div></div></div><footer><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><ul class="list-inline text-center footer-links"><li><a href=https://github.com/xizzhu title=GitHub><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-github fa-stack-1x fa-inverse"></i></span></a></li><li><a href=https://linkedin.com/in/xizhizhu title=LinkedIn><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-linkedin fa-stack-1x fa-inverse"></i></span></a></li><li><a href=https://stackoverflow.com/users/1664863/xizzhu title=StackOverflow><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-stack-overflow fa-stack-1x fa-inverse"></i></span></a></li></ul><p class="credits copyright text-muted">Xizhi Zhu
&nbsp;&bull;&nbsp;&copy;
2023
&nbsp;&bull;&nbsp;
<a href=https://xizzhu.me/>xizzhu</a></p><p class="credits theme-by text-muted"><a href=https://gohugo.io>Hugo v0.111.3</a> powered &nbsp;&bull;&nbsp; Theme <a href=https://github.com/halogenica/beautifulhugo>Beautiful Hugo</a> adapted from <a href=https://deanattali.com/beautiful-jekyll/>Beautiful Jekyll</a></p></div></div></div></footer><script src=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.js integrity=sha384-K3vbOmF2BtaVai+Qk37uypf7VrgBubhQreNQe9aGsz9lB63dIFiQVlJbr92dw2Lx crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/contrib/auto-render.min.js integrity=sha384-kmZOZB5ObwgQnS/DuDg6TScgOiWWBiVt0plIRkZCmE6rDZGrEOQeHM5PcHi+nyqe crossorigin=anonymous></script>
<script src=https://code.jquery.com/jquery-1.12.4.min.js integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin=anonymous></script>
<script src=https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js integrity=sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa crossorigin=anonymous></script>
<script src=https://xizzhu.me/js/main.js></script><script>renderMathInElement(document.body)</script><script src=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.js integrity=sha384-QELNnmcmU8IR9ZAykt67vGr9/rZJdHbiWi64V88fCPaOohUlHCqUD/unNN0BXSqy crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe-ui-default.min.js integrity=sha384-m67o7SkQ1ALzKZIFh4CiTA8tmadaujiTa9Vu+nqPSwDOqHrDmxLezTdFln8077+q crossorigin=anonymous></script><script src=https://xizzhu.me/js/load-photoswipe.js></script></body></html>